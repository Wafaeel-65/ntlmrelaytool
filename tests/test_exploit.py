import unittest
import pytest
from src.modules.exploit.relay import Relay
from src.modules.exploit.cracker import Cracker

class TestRelay(unittest.TestCase):
    def setUp(self):
        self.relay = Relay()

    def test_start_relay(self):
        result = self.relay.start_relay()
        self.assertTrue(result)

    def test_stop_relay(self):
        self.relay.start_relay()
        result = self.relay.stop_relay()
        self.assertTrue(result)

class TestCracker(unittest.TestCase):
    def setUp(self):
        self.cracker = Cracker()

    def test_crack_hash(self):
        test_hash = "d8578edf8458ce06fbc5bb76a58c5ca4"
        wordlist = ["qwerty", "password", "abc123", "hello", "letmein"]
        result = self.cracker.crack_hash(test_hash, wordlist)
        self.assertEqual(result, "qwerty")

def test_relay_init():
    relay = Relay()
    assert relay.running == False

def test_relay_start():
    relay = Relay()
    relay.start_relay()
    assert relay.running == True

def test_relay_stop():
    relay = Relay()
    relay.start_relay()
    relay.stop_relay()
    assert relay.running == False

if __name__ == '__main__':
    unittest.main()